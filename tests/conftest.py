import os
from typing import Any

import numpy as np
import pandas as pd
import pytest

from bimorph_mirror_analysis.app import DataDict

# Prevent pytest from catching exceptions when debugging in vscode so that break on
# exception works correctly (see: https://github.com/pytest-dev/pytest/issues/7409)
if os.getenv("PYTEST_RAISE", "0") == "1":

    @pytest.hookimpl(tryfirst=True)
    def pytest_exception_interact(call: pytest.CallInfo[Any]):
        if call.excinfo is not None:
            raise call.excinfo.value
        else:
            raise RuntimeError(
                f"{call} has no exception data, an unknown error has occurred"
            )

    @pytest.hookimpl(tryfirst=True)
    def pytest_internalerror(excinfo: pytest.ExceptionInfo[Any]):
        raise excinfo.value


@pytest.fixture
def raw_data() -> pd.DataFrame:
    data = """voltage_channel_1,voltage_channel_2,voltage_channel_3,slit_position_x,\
slit_width_x,slit_position_y,slit_width_y,centroid_position_x,centroid_position_y,pencil_beam_scan_number
    0,0,0,0.0,1,0,1,0.902155003650946,0.9059778816847021,0
    0,0,0,0.5,1,0,1,0.974760013427511,0.048632530864663126,0
    0,0,0,1.0,1,0,1,0.628935425613454,0.11203132765051338,0
    0,0,0,1.5,1,0,1,0.7762649318706349,0.2719190769515324,0
    0,0,0,2.0,1,0,1,0.5071122837043811,0.611609088123056,0
    0,0,0,2.5,1,0,1,0.3474659308224035,0.03510213867906076,0
    0,0,0,3.0,1,0,1,0.3284992604576076,0.99208831627924,0
    0,0,0,3.5,1,0,1,0.7295178626505394,0.5103013553152209,0
    0,0,0,4.0,1,0,1,0.14850099035491915,0.07969729764666311,0
    0,0,0,4.5,1,0,1,0.022176039254447888,0.049619315174349476,0
    0,0,0,5.0,1,0,1,0.35295771305012513,0.9557024629963558,0
    0,0,0,5.5,1,0,1,0.7179675309214435,0.2055059586891408,0
    0,0,0,6.0,1,0,1,0.6499835221868125,0.606285488948628,0
    0,0,0,6.5,1,0,1,0.47779199219005,0.6546623731441139,0
    0,0,0,7.0,1,0,1,0.9336634732337328,0.3136740595705516,0
    0,0,0,7.5,1,0,1,0.009520569061363338,0.8063235605316648,0
    0,0,0,8.0,1,0,1,0.7158395576862129,0.5122984261799449,0
    0,0,0,8.5,1,0,1,0.2716444289557093,0.5507234769303935,0
    0,0,0,9.0,1,0,1,0.9930168604136324,0.8152365237183438,0
    0,0,0,9.5,1,0,1,0.4129681812988907,0.8023526931635533,0
    0,0,0,10.0,1,0,1,0.6674668944557347,0.4174468364062732,0
    100,0,0,0.0,1,0,1,0.5546590484621201,0.8304502838039677,1
    100,0,0,0.5,1,0,1,0.13906662116959356,0.17335719779661474,1
    100,0,0,1.0,1,0,1,0.8798442985528538,0.6082544403694868,1
    100,0,0,1.5,1,0,1,0.18419363414361012,0.8916318274563698,1
    100,0,0,2.0,1,0,1,0.8711036413523057,0.7004663717770345,1
    100,0,0,2.5,1,0,1,0.9099533074121638,0.5582690692187812,1
    100,0,0,3.0,1,0,1,0.7802219284321528,0.5448810133045838,1
    100,0,0,3.5,1,0,1,0.9206330646867245,0.9704364812040612,1
    100,0,0,4.0,1,0,1,0.40940536712510833,0.5267501604276668,1
    100,0,0,4.5,1,0,1,0.0896507221276781,0.9367451946136546,1
    100,0,0,5.0,1,0,1,0.2712519699376731,0.8318670004689493,1
    100,0,0,5.5,1,0,1,0.536044487634938,0.8376715817809228,1
    100,0,0,6.0,1,0,1,0.43025265873767304,0.3787406941706395,1
    100,0,0,6.5,1,0,1,0.3847349424152309,0.10274579669497463,1
    100,0,0,7.0,1,0,1,0.15897565790767731,0.20601860566024477,1
    100,0,0,7.5,1,0,1,0.33067777617929583,0.6736142304595877,1
    100,0,0,8.0,1,0,1,0.11858344701673051,0.6782032580859674,1
    100,0,0,8.5,1,0,1,0.4286248262035558,0.9895136712839148,1
    100,0,0,9.0,1,0,1,0.7180884861749929,0.056036359595403096,1
    100,0,0,9.5,1,0,1,0.26499046575096896,0.39912112255467724,1
    100,0,0,10.0,1,0,1,0.14379259711280845,0.14106802929088103,1
    100,100,0,0.0,1,0,1,0.7233918949216122,0.982168455516603,2
    100,100,0,0.5,1,0,1,0.290742792709767,0.12776420966496438,2
    100,100,0,1.0,1,0,1,0.13799656543141725,0.6898436988997922,2
    100,100,0,1.5,1,0,1,0.7966501007242092,0.10121665939974611,2
    100,100,0,2.0,1,0,1,0.6035548318312184,0.5266494061788435,2
    100,100,0,2.5,1,0,1,0.8745250527670112,0.2783673425712273,2
    100,100,0,3.0,1,0,1,0.2199662395829104,0.8628343609007396,2
    100,100,0,3.5,1,0,1,0.21397922232247635,0.14932168483955655,2
    100,100,0,4.0,1,0,1,0.6491136779321542,0.9677149734414517,2
    100,100,0,4.5,1,0,1,0.521585333219087,0.3555822165846366,2
    100,100,0,5.0,1,0,1,0.2878937119272532,0.9483878657266134,2
    100,100,0,5.5,1,0,1,0.5528976167527797,0.2989377930464553,2
    100,100,0,6.0,1,0,1,0.2348080763889996,0.27979916967784824,2
    100,100,0,6.5,1,0,1,0.22744100740205286,0.8218958168136187,2
    100,100,0,7.0,1,0,1,0.18745517586190308,0.6605989632183804,2
    100,100,0,7.5,1,0,1,0.6481645591784894,0.6263681865745402,2
    100,100,0,8.0,1,0,1,0.16260780954429876,0.27381083790754324,2
    100,100,0,8.5,1,0,1,0.1579859256512237,0.9062488979864969,2
    100,100,0,9.0,1,0,1,0.37772126256203997,0.7955668100253056,2
    100,100,0,9.5,1,0,1,0.2295136220510665,0.8019070476612383,2
    100,100,0,10.0,1,0,1,0.8681643230023325,0.5923396832700695,2
    100,100,100,0.0,1,0,1,0.232850273843354,0.3203071762815356,3
    100,100,100,0.5,1,0,1,0.39422707347590746,0.9169444346778486,3
    100,100,100,1.0,1,0,1,0.5195777869079362,0.933578081913559,3
    100,100,100,1.5,1,0,1,0.3055357289931444,0.13087372577687528,3
    100,100,100,2.0,1,0,1,0.7483418094894336,0.07346239072990834,3
    100,100,100,2.5,1,0,1,0.696346546725722,0.7225571582190516,3
    100,100,100,3.0,1,0,1,0.9724618758170118,0.9471159228590665,3
    100,100,100,3.5,1,0,1,0.21177070577236934,0.6092750600252596,3
    100,100,100,4.0,1,0,1,0.9916829027154486,0.9626893747544218,3
    100,100,100,4.5,1,0,1,0.474706589914094,0.8168984615795551,3
    100,100,100,5.0,1,0,1,0.28338124640130735,0.9619912615534008,3
    100,100,100,5.5,1,0,1,0.5541329846866376,0.6162100171902787,3
    100,100,100,6.0,1,0,1,0.4041186292722393,0.7502255535642713,3
    100,100,100,6.5,1,0,1,0.9755649555219787,0.6290253229311905,3
    100,100,100,7.0,1,0,1,0.7228182241678169,0.2973982599315711,3
    100,100,100,7.5,1,0,1,0.29495423356560835,0.005345110272705567,3
    100,100,100,8.0,1,0,1,0.2785374723069234,0.2728282979215154,3
    100,100,100,8.5,1,0,1,0.004064948618126452,0.658081995540037,3
    100,100,100,9.0,1,0,1,0.6907922378507042,0.17092071374050632,3
    100,100,100,9.5,1,0,1,0.3965148737759935,0.04638829999092675,3
    100,100,100,10.0,1,0,1,0.8706751462033909,0.7206080303974453,3"""
    df = pd.DataFrame(
        [row.split(",") for row in data.split("\n")[1:]],
        columns=data.split("\n")[0].split(","),
    )  # type: ignore
    return df.apply(pd.to_numeric, errors="coerce")  # type: ignore


@pytest.fixture
def raw_data_pivoted() -> pd.DataFrame:
    data = """slit_position_x,pencil_beam_scan_0,pencil_beam_scan_1,pencil_beam_scan_2\
,pencil_beam_scan_3
    0.0,0.902155003650946,0.5546590484621201,0.7233918949216122,0.232850273843354
    0.5,0.974760013427511,0.1390666211695935,0.290742792709767,0.3942270734759074
    1.0,0.628935425613454,0.8798442985528538,0.1379965654314172,0.5195777869079362
    1.5,0.7762649318706349,0.1841936341436101,0.7966501007242092,0.3055357289931444
    2.0,0.5071122837043811,0.8711036413523057,0.6035548318312184,0.7483418094894336
    2.5,0.3474659308224035,0.9099533074121638,0.8745250527670112,0.696346546725722
    3.0,0.3284992604576076,0.7802219284321528,0.2199662395829104,0.9724618758170118
    3.5,0.7295178626505394,0.9206330646867243,0.2139792223224763,0.2117707057723693
    4.0,0.1485009903549191,0.4094053671251083,0.6491136779321542,0.9916829027154486
    4.5,0.0221760392544478,0.0896507221276781,0.521585333219087,0.474706589914094
    5.0,0.3529577130501251,0.2712519699376731,0.2878937119272532,0.2833812464013073
    5.5,0.7179675309214435,0.536044487634938,0.5528976167527797,0.5541329846866376
    6.0,0.6499835221868125,0.430252658737673,0.2348080763889996,0.4041186292722393
    6.5,0.47779199219005,0.3847349424152309,0.2274410074020528,0.9755649555219787
    7.0,0.9336634732337328,0.1589756579076773,0.187455175861903,0.7228182241678169
    7.5,0.0095205690613633,0.3306777761792958,0.6481645591784894,0.2949542335656083
    8.0,0.7158395576862129,0.1185834470167305,0.1626078095442987,0.2785374723069234
    8.5,0.2716444289557093,0.4286248262035558,0.1579859256512237,0.0040649486181264
    9.0,0.9930168604136324,0.7180884861749929,0.3777212625620399,0.6907922378507042
    9.5,0.4129681812988907,0.2649904657509689,0.2295136220510665,0.3965148737759935
    10.0,0.6674668944557347,0.1437925971128084,0.8681643230023325,0.8706751462033909"""
    df = pd.DataFrame(
        [row.split(",") for row in data.split("\n")[1:]],
        columns=data.split("\n")[0].split(","),
    )  # type: ignore
    return df.apply(pd.to_numeric, errors="coerce")  # type: ignore


@pytest.fixture
def actuator_data(
    request: pytest.FixtureRequest,
) -> tuple[
    np.typing.NDArray[np.float64],
    np.typing.NDArray[np.float64],
    np.typing.NDArray[np.float64],
]:
    input_path, output_path, initial_voltages_path = request.param
    data = np.loadtxt(input_path, delimiter=",")
    expected_corrections = np.loadtxt(output_path, delimiter=",")
    initial_voltages = np.loadtxt(initial_voltages_path, delimiter=",")
    return data, expected_corrections, initial_voltages



@pytest.fixture
def data_dict(raw_data: pd.DataFrame, raw_data_pivoted: pd.DataFrame) -> DataDict:
    output: DataDict = {
        "raw_data_dict": raw_data.to_dict(),  # type: ignore
        "pivoted_data_dict": raw_data_pivoted.to_dict(),  # type: ignore
        "initial_voltages": np.array([0.0, 0.0, 0.0]),
        "increment": 100.0,
        "filename": "raw_data.csv",
    }

    return output


@pytest.fixture
def encoded_file() -> str:
    output = "data:text/csv;base64,dm9sdGFnZV9jaGFubmVsXzEsdm9sdGFnZV9jaGFubmVsXzIsdm9s\
dGFnZV9jaGFubm\
VsXzMsc2xpdF9wb3NpdGlvbl94LHNsaXRfd2lkdGhfeCxzbGl0X3Bvc2l0aW9uX3ksc2xpdF93aWR0aF95LGNlb\
nRyb2lkX3Bvc2l0aW9uX3gsY2VudHJvaWRfcG9zaXRpb25feSxwZW5jaWxfYmVhbV9zY2FuX251bWJlcgowLDAs\
MCwwLjAsMSwwLDEsMC45MDIxNTUwMDM2NTA5NDYsMC45MDU5Nzc4ODE2ODQ3MDIxLDAKMCwwLDAsMC41LDEsMCw\
xLDAuOTc0NzYwMDEzNDI3NTExLDAuMDQ4NjMyNTMwODY0NjYzMTI2LDAKMCwwLDAsMS4wLDEsMCwxLDAuNjI4OT\
M1NDI1NjEzNDU0LDAuMTEyMDMxMzI3NjUwNTEzMzgsMAowLDAsMCwxLjUsMSwwLDEsMC43NzYyNjQ5MzE4NzA2M\
zQ5LDAuMjcxOTE5MDc2OTUxNTMyNCwwCjAsMCwwLDIuMCwxLDAsMSwwLjUwNzExMjI4MzcwNDM4MTEsMC42MTE2\
MDkwODgxMjMwNTYsMAowLDAsMCwyLjUsMSwwLDEsMC4zNDc0NjU5MzA4MjI0MDM1LDAuMDM1MTAyMTM4Njc5MDY\
wNzYsMAowLDAsMCwzLjAsMSwwLDEsMC4zMjg0OTkyNjA0NTc2MDc2LDAuOTkyMDg4MzE2Mjc5MjQsMAowLDAsMC\
wzLjUsMSwwLDEsMC43Mjk1MTc4NjI2NTA1Mzk0LDAuNTEwMzAxMzU1MzE1MjIwOSwwCjAsMCwwLDQuMCwxLDAsM\
SwwLjE0ODUwMDk5MDM1NDkxOTE1LDAuMDc5Njk3Mjk3NjQ2NjYzMTEsMAowLDAsMCw0LjUsMSwwLDEsMC4wMjIx\
NzYwMzkyNTQ0NDc4ODgsMC4wNDk2MTkzMTUxNzQzNDk0NzYsMAowLDAsMCw1LjAsMSwwLDEsMC4zNTI5NTc3MTM\
wNTAxMjUxMywwLjk1NTcwMjQ2Mjk5NjM1NTgsMAowLDAsMCw1LjUsMSwwLDEsMC43MTc5Njc1MzA5MjE0NDM1LD\
AuMjA1NTA1OTU4Njg5MTQwOCwwCjAsMCwwLDYuMCwxLDAsMSwwLjY0OTk4MzUyMjE4NjgxMjUsMC42MDYyODU0O\
Dg5NDg2MjgsMAowLDAsMCw2LjUsMSwwLDEsMC40Nzc3OTE5OTIxOTAwNSwwLjY1NDY2MjM3MzE0NDExMzksMAow\
LDAsMCw3LjAsMSwwLDEsMC45MzM2NjM0NzMyMzM3MzI4LDAuMzEzNjc0MDU5NTcwNTUxNiwwCjAsMCwwLDcuNSw\
xLDAsMSwwLjAwOTUyMDU2OTA2MTM2MzMzOCwwLjgwNjMyMzU2MDUzMTY2NDgsMAowLDAsMCw4LjAsMSwwLDEsMC\
43MTU4Mzk1NTc2ODYyMTI5LDAuNTEyMjk4NDI2MTc5OTQ0OSwwCjAsMCwwLDguNSwxLDAsMSwwLjI3MTY0NDQyO\
Dk1NTcwOTMsMC41NTA3MjM0NzY5MzAzOTM1LDAKMCwwLDAsOS4wLDEsMCwxLDAuOTkzMDE2ODYwNDEzNjMyNCww\
LjgxNTIzNjUyMzcxODM0MzgsMAowLDAsMCw5LjUsMSwwLDEsMC40MTI5NjgxODEyOTg4OTA3LDAuODAyMzUyNjk\
zMTYzNTUzMywwCjAsMCwwLDEwLjAsMSwwLDEsMC42Njc0NjY4OTQ0NTU3MzQ3LDAuNDE3NDQ2ODM2NDA2MjczMi\
wwCjEwMCwwLDAsMC4wLDEsMCwxLDAuNTU0NjU5MDQ4NDYyMTIwMSwwLjgzMDQ1MDI4MzgwMzk2NzcsMQoxMDAsM\
CwwLDAuNSwxLDAsMSwwLjEzOTA2NjYyMTE2OTU5MzU2LDAuMTczMzU3MTk3Nzk2NjE0NzQsMQoxMDAsMCwwLDEu\
MCwxLDAsMSwwLjg3OTg0NDI5ODU1Mjg1MzgsMC42MDgyNTQ0NDAzNjk0ODY4LDEKMTAwLDAsMCwxLjUsMSwwLDE\
sMC4xODQxOTM2MzQxNDM2MTAxMiwwLjg5MTYzMTgyNzQ1NjM2OTgsMQoxMDAsMCwwLDIuMCwxLDAsMSwwLjg3MT\
EwMzY0MTM1MjMwNTcsMC43MDA0NjYzNzE3NzcwMzQ1LDEKMTAwLDAsMCwyLjUsMSwwLDEsMC45MDk5NTMzMDc0M\
TIxNjM4LDAuNTU4MjY5MDY5MjE4NzgxMiwxCjEwMCwwLDAsMy4wLDEsMCwxLDAuNzgwMjIxOTI4NDMyMTUyOCww\
LjU0NDg4MTAxMzMwNDU4MzgsMQoxMDAsMCwwLDMuNSwxLDAsMSwwLjkyMDYzMzA2NDY4NjcyNDUsMC45NzA0MzY\
0ODEyMDQwNjEyLDEKMTAwLDAsMCw0LjAsMSwwLDEsMC40MDk0MDUzNjcxMjUxMDgzMywwLjUyNjc1MDE2MDQyNz\
Y2NjgsMQoxMDAsMCwwLDQuNSwxLDAsMSwwLjA4OTY1MDcyMjEyNzY3ODEsMC45MzY3NDUxOTQ2MTM2NTQ2LDEKM\
TAwLDAsMCw1LjAsMSwwLDEsMC4yNzEyNTE5Njk5Mzc2NzMxLDAuODMxODY3MDAwNDY4OTQ5MywxCjEwMCwwLDAs\
NS41LDEsMCwxLDAuNTM2MDQ0NDg3NjM0OTM4LDAuODM3NjcxNTgxNzgwOTIyOCwxCjEwMCwwLDAsNi4wLDEsMCw\
xLDAuNDMwMjUyNjU4NzM3NjczMDQsMC4zNzg3NDA2OTQxNzA2Mzk1LDEKMTAwLDAsMCw2LjUsMSwwLDEsMC4zOD\
Q3MzQ5NDI0MTUyMzA5LDAuMTAyNzQ1Nzk2Njk0OTc0NjMsMQoxMDAsMCwwLDcuMCwxLDAsMSwwLjE1ODk3NTY1N\
zkwNzY3NzMxLDAuMjA2MDE4NjA1NjYwMjQ0NzcsMQoxMDAsMCwwLDcuNSwxLDAsMSwwLjMzMDY3Nzc3NjE3OTI5\
NTgzLDAuNjczNjE0MjMwNDU5NTg3NywxCjEwMCwwLDAsOC4wLDEsMCwxLDAuMTE4NTgzNDQ3MDE2NzMwNTEsMC4\
2NzgyMDMyNTgwODU5Njc0LDEKMTAwLDAsMCw4LjUsMSwwLDEsMC40Mjg2MjQ4MjYyMDM1NTU4LDAuOTg5NTEzNj\
cxMjgzOTE0OCwxCjEwMCwwLDAsOS4wLDEsMCwxLDAuNzE4MDg4NDg2MTc0OTkyOSwwLjA1NjAzNjM1OTU5NTQwM\
zA5NiwxCjEwMCwwLDAsOS41LDEsMCwxLDAuMjY0OTkwNDY1NzUwOTY4OTYsMC4zOTkxMjExMjI1NTQ2NzcyNCwx\
CjEwMCwwLDAsMTAuMCwxLDAsMSwwLjE0Mzc5MjU5NzExMjgwODQ1LDAuMTQxMDY4MDI5MjkwODgxMDMsMQoxMDA\
sMTAwLDAsMC4wLDEsMCwxLDAuNzIzMzkxODk0OTIxNjEyMiwwLjk4MjE2ODQ1NTUxNjYwMywyCjEwMCwxMDAsMC\
wwLjUsMSwwLDEsMC4yOTA3NDI3OTI3MDk3NjcsMC4xMjc3NjQyMDk2NjQ5NjQzOCwyCjEwMCwxMDAsMCwxLjAsM\
SwwLDEsMC4xMzc5OTY1NjU0MzE0MTcyNSwwLjY4OTg0MzY5ODg5OTc5MjIsMgoxMDAsMTAwLDAsMS41LDEsMCwx\
LDAuNzk2NjUwMTAwNzI0MjA5MiwwLjEwMTIxNjY1OTM5OTc0NjExLDIKMTAwLDEwMCwwLDIuMCwxLDAsMSwwLjY\
wMzU1NDgzMTgzMTIxODQsMC41MjY2NDk0MDYxNzg4NDM1LDIKMTAwLDEwMCwwLDIuNSwxLDAsMSwwLjg3NDUyNT\
A1Mjc2NzAxMTIsMC4yNzgzNjczNDI1NzEyMjczLDIKMTAwLDEwMCwwLDMuMCwxLDAsMSwwLjIxOTk2NjIzOTU4M\
jkxMDQsMC44NjI4MzQzNjA5MDA3Mzk2LDIKMTAwLDEwMCwwLDMuNSwxLDAsMSwwLjIxMzk3OTIyMjMyMjQ3NjM1\
LDAuMTQ5MzIxNjg0ODM5NTU2NTUsMgoxMDAsMTAwLDAsNC4wLDEsMCwxLDAuNjQ5MTEzNjc3OTMyMTU0MiwwLjk\
2NzcxNDk3MzQ0MTQ1MTcsMgoxMDAsMTAwLDAsNC41LDEsMCwxLDAuNTIxNTg1MzMzMjE5MDg3LDAuMzU1NTgyMj\
E2NTg0NjM2NiwyCjEwMCwxMDAsMCw1LjAsMSwwLDEsMC4yODc4OTM3MTE5MjcyNTMyLDAuOTQ4Mzg3ODY1NzI2N\
jEzNCwyCjEwMCwxMDAsMCw1LjUsMSwwLDEsMC41NTI4OTc2MTY3NTI3Nzk3LDAuMjk4OTM3NzkzMDQ2NDU1Mywy\
CjEwMCwxMDAsMCw2LjAsMSwwLDEsMC4yMzQ4MDgwNzYzODg5OTk2LDAuMjc5Nzk5MTY5Njc3ODQ4MjQsMgoxMDA\
sMTAwLDAsNi41LDEsMCwxLDAuMjI3NDQxMDA3NDAyMDUyODYsMC44MjE4OTU4MTY4MTM2MTg3LDIKMTAwLDEwMC\
wwLDcuMCwxLDAsMSwwLjE4NzQ1NTE3NTg2MTkwMzA4LDAuNjYwNTk4OTYzMjE4MzgwNCwyCjEwMCwxMDAsMCw3L\
jUsMSwwLDEsMC42NDgxNjQ1NTkxNzg0ODk0LDAuNjI2MzY4MTg2NTc0NTQwMiwyCjEwMCwxMDAsMCw4LjAsMSww\
LDEsMC4xNjI2MDc4MDk1NDQyOTg3NiwwLjI3MzgxMDgzNzkwNzU0MzI0LDIKMTAwLDEwMCwwLDguNSwxLDAsMSw\
wLjE1Nzk4NTkyNTY1MTIyMzcsMC45MDYyNDg4OTc5ODY0OTY5LDIKMTAwLDEwMCwwLDkuMCwxLDAsMSwwLjM3Nz\
cyMTI2MjU2MjAzOTk3LDAuNzk1NTY2ODEwMDI1MzA1NiwyCjEwMCwxMDAsMCw5LjUsMSwwLDEsMC4yMjk1MTM2M\
jIwNTEwNjY1LDAuODAxOTA3MDQ3NjYxMjM4MywyCjEwMCwxMDAsMCwxMC4wLDEsMCwxLDAuODY4MTY0MzIzMDAy\
MzMyNSwwLjU5MjMzOTY4MzI3MDA2OTUsMgoxMDAsMTAwLDEwMCwwLjAsMSwwLDEsMC4yMzI4NTAyNzM4NDMzNTQ\
sMC4zMjAzMDcxNzYyODE1MzU2LDMKMTAwLDEwMCwxMDAsMC41LDEsMCwxLDAuMzk0MjI3MDczNDc1OTA3NDYsMC\
45MTY5NDQ0MzQ2Nzc4NDg2LDMKMTAwLDEwMCwxMDAsMS4wLDEsMCwxLDAuNTE5NTc3Nzg2OTA3OTM2MiwwLjkzM\
zU3ODA4MTkxMzU1OSwzCjEwMCwxMDAsMTAwLDEuNSwxLDAsMSwwLjMwNTUzNTcyODk5MzE0NDQsMC4xMzA4NzM3\
MjU3NzY4NzUyOCwzCjEwMCwxMDAsMTAwLDIuMCwxLDAsMSwwLjc0ODM0MTgwOTQ4OTQzMzYsMC4wNzM0NjIzOTA\
3Mjk5MDgzNCwzCjEwMCwxMDAsMTAwLDIuNSwxLDAsMSwwLjY5NjM0NjU0NjcyNTcyMiwwLjcyMjU1NzE1ODIxOT\
A1MTYsMwoxMDAsMTAwLDEwMCwzLjAsMSwwLDEsMC45NzI0NjE4NzU4MTcwMTE4LDAuOTQ3MTE1OTIyODU5MDY2N\
SwzCjEwMCwxMDAsMTAwLDMuNSwxLDAsMSwwLjIxMTc3MDcwNTc3MjM2OTM0LDAuNjA5Mjc1MDYwMDI1MjU5Niwz\
CjEwMCwxMDAsMTAwLDQuMCwxLDAsMSwwLjk5MTY4MjkwMjcxNTQ0ODYsMC45NjI2ODkzNzQ3NTQ0MjE4LDMKMTA\
wLDEwMCwxMDAsNC41LDEsMCwxLDAuNDc0NzA2NTg5OTE0MDk0LDAuODE2ODk4NDYxNTc5NTU1MSwzCjEwMCwxMD\
AsMTAwLDUuMCwxLDAsMSwwLjI4MzM4MTI0NjQwMTMwNzM1LDAuOTYxOTkxMjYxNTUzNDAwOCwzCjEwMCwxMDAsM\
TAwLDUuNSwxLDAsMSwwLjU1NDEzMjk4NDY4NjYzNzYsMC42MTYyMTAwMTcxOTAyNzg3LDMKMTAwLDEwMCwxMDAs\
Ni4wLDEsMCwxLDAuNDA0MTE4NjI5MjcyMjM5MywwLjc1MDIyNTU1MzU2NDI3MTMsMwoxMDAsMTAwLDEwMCw2LjU\
sMSwwLDEsMC45NzU1NjQ5NTU1MjE5Nzg3LDAuNjI5MDI1MzIyOTMxMTkwNSwzCjEwMCwxMDAsMTAwLDcuMCwxLD\
AsMSwwLjcyMjgxODIyNDE2NzgxNjksMC4yOTczOTgyNTk5MzE1NzExLDMKMTAwLDEwMCwxMDAsNy41LDEsMCwxL\
DAuMjk0OTU0MjMzNTY1NjA4MzUsMC4wMDUzNDUxMTAyNzI3MDU1NjcsMwoxMDAsMTAwLDEwMCw4LjAsMSwwLDEs\
MC4yNzg1Mzc0NzIzMDY5MjM0LDAuMjcyODI4Mjk3OTIxNTE1NCwzCjEwMCwxMDAsMTAwLDguNSwxLDAsMSwwLjA\
wNDA2NDk0ODYxODEyNjQ1MiwwLjY1ODA4MTk5NTU0MDAzNywzCjEwMCwxMDAsMTAwLDkuMCwxLDAsMSwwLjY5MD\
c5MjIzNzg1MDcwNDIsMC4xNzA5MjA3MTM3NDA1MDYzMiwzCjEwMCwxMDAsMTAwLDkuNSwxLDAsMSwwLjM5NjUxN\
Dg3Mzc3NTk5MzUsMC4wNDYzODgyOTk5OTA5MjY3NSwzCjEwMCwxMDAsMTAwLDEwLjAsMSwwLDEsMC44NzA2NzUx\
NDYyMDMzOTA5LDAuNzIwNjA4MDMwMzk3NDQ1MywzCg=="
    return output
